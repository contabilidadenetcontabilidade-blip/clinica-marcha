<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <title>Marcha ReabilitaÃ§Ã£o e PerÃ­cia</title>
  <link rel="stylesheet" href="style.css" />
  <script>
    const user = JSON.parse(localStorage.getItem('user'));
    if (!user || (user.role !== 'admin' && user.role !== 'fisio')) {
      window.location.href = 'login.html';
    }
  </script>
</head>

<body>

  <header class="topbar">
    <a href="index.html" class="brand">
      <img src="../assets/logo_marcha.png" alt="Logo" class="logo">
      <span class="title">ClÃ­nica Marcha</span>
    </a>
    <nav class="nav-links">
      <a href="index.html" class="nav-item active">ğŸ  <span>InÃ­cio</span></a>
      <a href="agenda.html" class="nav-item">ğŸ“… <span>Agenda</span></a>
      <a href="pacientes.html" class="nav-item">ğŸ‘¥ <span>Clientes & Alunos</span></a>
      <a href="financeiro.html" class="nav-item">ğŸ’° <span>Financeiro</span></a>
      <a href="profissionais.html" class="nav-item">ğŸ¥¼ <span>Profissionais</span></a>
      <a href="#" onclick="logout()" class="nav-item" style="color: #f44336;">ğŸšª <span>Sair</span></a>
    </nav>
  </header>

  <main class="dashboard-container">
    <div class="page-header">
      <h1>Dashboard Executivo</h1>
      <p style="color: #666;">VisÃ£o geral da ClÃ­nica Marcha</p>
    </div>

    <!-- 1. Summary Cards -->
    <div class="summary-cards">
      <div class="card summary-card-dashboard">
        <div class="icon-bg">ğŸ’°</div>
        <div>
          <h3>Faturamento (MÃªs)</h3>
          <p class="value" id="dashboard-total-revenue">R$ 0,00</p>
          <span class="subtext">Receitas confirmadas</span>
        </div>
      </div>
      <div class="card summary-card-dashboard">
        <div class="icon-bg">ğŸ‘¥</div>
        <div>
          <h3>Clientes Ativos</h3>
          <p class="value" id="dashboard-active-patients">0</p>
          <span class="subtext">Cadastrados e ativos</span>
        </div>
      </div>
      <div class="card summary-card-dashboard">
        <div class="icon-bg">ğŸ†</div>
        <div>
          <h3>LÃ­der Marcha Cup</h3>
          <p class="value" id="dashboard-cup-leader">-</p>
          <span class="subtext">Casa em 1Âº lugar</span>
        </div>
      </div>
    </div>

    <!-- 2. Charts & Ranking Grid -->
    <div class="dashboard-grid">
      <!-- Finance Pie Chart -->
      <div class="card chart-card">
        <h3>Receitas vs. Despesas</h3>
        <div class="chart-container">
          <canvas id="financePieChart"></canvas>
        </div>
      </div>

      <!-- Appointments Bar Chart -->
      <div class="card chart-card">
        <h3>Atendimentos por Modalidade</h3>
        <div class="chart-container">
          <canvas id="appointmentsBarChart"></canvas>
        </div>
      </div>

      <!-- Ranking (Existing Logic) -->
      <div class="card ranking-card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h3 style="margin:0;">ğŸ† Ranking Atual</h3>
          <button onclick="window.location.href='cup.html'" class="btn-secondary btn-sm">Ver Detalhes</button>
        </div>
        <div id="ranking-container" class="ranking-list">
          <div style="text-align: center; color: #666;">Carregando ranking...</div>
        </div>
        <!-- Hidden button needed for logic? Logic probably targets #ranking-container -->
      </div>
    </div>

  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="utils.js"></script>
  <script src="app.js"></script>
</body>

</html>